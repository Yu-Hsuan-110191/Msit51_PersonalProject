<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="keywords" content="HTML, CSS, JavaScript">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>美球水餃-鮮肉餛飩</title>
    <link rel="icon" href="./img cs/logom0728小正.png">
    <link href="./分頁.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="./首頁.CSS">
    <script src="./jquery-3.7.0.min.js"></script>
    <script src="./jquery-ui.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
    <div id="NAV">
        <header>

            <!-- 導覽列 -->
            <div id="logo">
                <a href="./首頁.html"><img style="height: 80%;" src="./img cs/logom0728.png" alt="美球水餃"></a>

            </div>
            <nav>
                <ul class="menu">
                    <li><a href="./product.html">所有產品</a>

                    </li>
                    <li><a href="./store.html">門市資訊</a></li>
                    <li><a href="./FAQ.html">訂購須知</a></li>
                    <li></li>
                    <li></li>
                    <li></li>

                </ul>

            </nav>

        </header>
    </div>
    <div id="icons">
        <a href="./購物車.html"><i id="cartIcon" class="fa fa-shopping-cart" aria-hidden="true"></i>
            <div id="pN"></div>
        </a>
        <hr color="white">
        <a href="./signin.html"><i class="fa fa-user" aria-hidden="true"></i></a>
    </div>
    <div class="container">
        <!-- 左 -->
        <div id="leftBlock"></div>
        <!-- 中 -->
        <div id="centerBlock">
            <div id="Block">
                <div id="imgContainer" class="half" pImg="./img_product/pr/8.jpg">
                    <div class="rowImg"><img src="./img_product/pr/9.jpg" alt=""></div>
                    <div class="mainImg"><img src="./img_product/pr/8.jpg" alt="鮮肉餛飩"></div>
                </div>
                <div id="priceArea">
                    <h2 pID="B1" pPrice="165">鮮肉餛飩</h2>
                    <h3>NT$165</h3>

                    <p></p>
                    <div class="half" style="display: inline-flex;">
                        <table>
                            <tr>
                                <th><button onclick="plus(this, -1)" style="font-size: 18px;">-</button></th>
                                <th>1</th>
                                <th><button onclick="plus(this, 1)" style="font-size: 18px;">+</button></th>
                            </tr>
                        </table>
                        <button class="addCart">加入購物車</button>
                    </div>
                    <!-- <div style="text-align: left;">配合活動</div> -->
                </div>
                <br>
                <br>
                <!-- <hr> -->



            </div>
            <div id="pD">
                <h3 style="margin-bottom: 0;">商品描述</h3>
                <hr>
                <h4 style="line-height: 1.8;">
                    <ul>
                        <li>1包24入</li>
                        <li>成分：麵粉、豬肉(台灣)、高麗菜、青蔥、水、低鈉鹽、昆布高湯、大豆油、糖</li>
                        <li>淨重：720g+-15g</li>
                        <li>過敏原資訊：本產品含麩質及其製品</li>
                    </ul>
                </h4>
                <h3 style="margin-bottom: 0;">你可能也喜歡</h3>
                <hr>
                <div class="half">
                    <div style="flex: 1;margin-right: 5px;"><img width="100%" src="./img_product/pr/2.jpg"></div>
                    <div style="flex: 1;margin-right: 5px"><img width="100%" src="./img_product/pr/3.jpg"></div>
                    <div style="flex: 1;margin-right: 5px"><img width="100%" src="./img_product/pr/4.jpg"></div>
                    <!-- <img src="../img_product/pr/2.jpg">
                    <img src="../img_product/pr/3.jpg">
                    <img src="../img_product/pr/4.jpg">
                    <img src="../img_product/pr/5.jpg">
                    <img src="../img_product/pr/6.jpg"> -->
                </div>

            </div>


        </div>
        <!-- 右 -->
        <div id="rightBlock"></div>

    </div>
    <div id="pageBottom">
        <hr>
        <a href="https://www.facebook.com/profile.php?id=100064288114627"><i class="fa fa-facebook"></i></a>
        <a href="https://www.facebook.com/profile.php?id=100064288114627"><i class="fa fa-instagram"></i></a>
        <a href="mailto:meicho@gmail.com">客服信箱：meicho@gmail.com</a>

    </div>
    <script>

        function plus(sender, value) {
            let field = $(sender)
                .parent()
                .parent()
                .children()
                .eq(1)


            let text = field.text()
            text = parseInt(text) + value
            if (text >= 1) {
                field.text(text)
            } else {
                text = 1
            }
        }

        $(function () {
            // product頁及商品分頁的加到購物車
            $(".addCart").click(function () {
                console.log("ok")
                var cart = [];
                if (localStorage.getItem("cart")) {
                    cart = JSON.parse(localStorage.getItem("cart"))
                } // 取得目前cart[]
                console.log(cart)
                // console.log("ok")
                // console.log(this)
                var pName = $(this).parent().parent().children()[0].innerText
                console.log(pName)

                var pID = $(this).parent().parent().children()[0].getAttribute("pID")
                console.log(pID)

                var pImg = $(this).parent().parent().parent().children()[0].getAttribute("pImg")
                console.log(pImg)

                var pQuanity = $(this).parent().children().children().children().children()[1].innerText
                console.log(pQuanity)

                var pPrice = $(this).parent().parent().children()[0].getAttribute("pPrice")
                console.log(pPrice)


                let newItem;
                if (cart.length > 0) {
                    let repeat = true;
                    for (var i = 0; i < cart.length; i++) {
                        console.log('9999999999is here!')
                        if (cart[i].pID === pID) {
                            console.log('555555555is here!')
                            console.log(pName)
                            cart[i].pQuanity = parseInt(cart[i].pQuanity) + parseInt(pQuanity)
                            repeat = false;
                        }
                    }

                    if (repeat) {
                        console.log('01010101is here!')
                        newItem = {
                            pName: pName,
                            pImg: pImg,
                            pQuanity: pQuanity,
                            pPrice: pPrice,
                            pID: pID,
                        }
                        console.log(newItem)

                        cart.push(newItem)
                        console.log(cart)
                    }

                } else {
                    console.log("2is here")
                    newItem = {
                        pName: pName,
                        pImg: pImg,
                        pQuanity: pQuanity,
                        pPrice: pPrice,
                        pID: pID
                    }
                    cart.push(newItem)
                    console.log(cart)
                }
                console.log(cart)
                localStorage.setItem("cart", JSON.stringify(cart))
            })

            var cart = [];
            cart = JSON.parse(localStorage.getItem("cart"))
            if (cart.length > 0) {
                pN.innerText = cart.length
                $("#pN").css("background-color", "white");
                $("#pN").css("border-color", "rgb(193, 39, 45)");
            }


        })
    </script>
</body>