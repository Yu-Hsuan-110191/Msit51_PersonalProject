<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="keywords" content="HTML, CSS, JavaScript">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>美球水餃-所有產品</title>
    <link href="./img cs/logom0728小正.png" rel="icon" type="gif">
    <link rel="stylesheet" href="./首頁.CSS">
    <link href="./product.css" rel="stylesheet" type="text/css">
    <script src="./jquery-3.7.0.min.js"></script>
    <script src="./jquery-ui.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

</head>

<body>
    <div id="NAV">
        <header>

            <!-- 導覽列 -->
            <div id="logo">
                <a href="./首頁.html"><img style="height: 80%;" src="./img cs/logom0728.png" alt="美球水餃"></a>

            </div>
            <nav>
                <ul class="menu">
                    <li><a href="./product.html">所有產品</a>

                    </li>
                    <li><a href="./store.html">門市資訊</a></li>
                    <li><a href="./FAQ.html">訂購須知</a></li>
                    <li></li>
                    <li></li>
                    <li></li>

                </ul>

            </nav>

        </header>
    </div>
    <div id="icons">
        <a href="./購物車.html"><i id="cartIcon" class="fa fa-shopping-cart" aria-hidden="true"></i>
            <div id="pN"></div>
        </a>
        <hr color="white">
        <a href="./signin.html"><i class="fa fa-user" aria-hidden="true"></i></a>
    </div>
    <div class="container">
        <!-- 左 -->
        <div id="leftBlock"></div>
        <!-- 中 -->
        <div id="centerBlock">
            <!-- 產品列表 -->
            <div id="Block">
                <div><a href="./高麗菜.html"><img src="./img_product/pr/1.jpg" alt="高麗菜水餃"></a><br>
                    <table>
                        <tr>
                            <th PID="A1" price="390" style="width: 200px;text-align: left;">翠雪高麗水餃<br></th>
                            <th><button onclick="plus(this, -1)" style="font-size: 18px;">-</button></th>
                            <th>1</th>
                            <th><button onclick="plus(this, 1)" style="font-size: 18px;">+</button></th>
                            <th><button class="addCart"><img src="./img cs/images.jpg" alt="加入購物車"
                                        style="height: 30px ;"></button></th>
                        </tr>
                        <tr>
                            <th price="390" style="width: 200px;text-align: left;">$390</th>
                        </tr>
                    </table>
                </div>

                <div><a href="./商品分頁/高麗菜.html"><img src="./img_product/pr/2.jpg" alt=""></a><br>
                    <table>
                        <tr>
                            <th PID="A2" price="400" style="width: 200px;text-align: left;">花蓮韭水餃<br></th>
                            <th><button onclick="plus(this, -1)" style="font-size: 18px;">-</button></th>
                            <th>1</th>
                            <th><button onclick="plus(this, 1)" style="font-size: 18px;">+</button></th>
                            <th><button class="addCart"><img src="./img cs/images.jpg" alt="加入購物車"
                                        style="height: 30px ;"></button></th>
                        </tr>
                        <tr>
                            <th price="400" style="width: 200px;text-align: left;">$400</th>
                        </tr>
                    </table>
                </div>

                <div><a href="./商品分頁/高麗菜.html"><img src="./img_product/pr/3.jpg" alt=""></a><br>
                    <table>
                        <tr>
                            <th PID="A3" price="380" style="width: 200px;text-align: left;">甜玉米鮮肉水餃<br></th>
                            <th><button onclick="plus(this, -1)" style="font-size: 18px;">-</button></th>
                            <th>1</th>
                            <th><button onclick="plus(this, 1)" style="font-size: 18px;">+</button></th>
                            <th><button class="addCart"><img src="./img cs/images.jpg" alt="加入購物車"
                                        style="height: 30px ;"></button></th>
                        </tr>
                        <tr>
                            <th price="380" style="width: 200px;text-align: left;">$380</th>
                        </tr>
                    </table>
                </div>
                <div><a href="./商品分頁/高麗菜.html"><img src="./img_product/pr/4.jpg" alt=""></a><br>
                    <table>
                        <tr>
                            <th PID="A4" price="410" style="width: 200px;text-align: left;">雪裡紅鮮肉水餃<br></th>
                            <th><button onclick="plus(this, -1)" style="font-size: 18px;">-</button></th>
                            <th>1</th>
                            <th><button onclick="plus(this, 1)" style="font-size: 18px;">+</button></th>
                            <th><button class="addCart"><img src="./img cs/images.jpg" alt="加入購物車"
                                        style="height: 30px ;"></button></th>
                        </tr>
                        <tr>
                            <th price="410" style="width: 200px;text-align: left;">$410</th>
                        </tr>
                    </table>
                </div>
                <div><a href="./商品分頁/高麗菜.html"><img src="./img_product/pr/5.jpg" alt=""></a><br>
                    <table>
                        <tr>
                            <th PID="A5" price="450" style="width: 200px;text-align: left;">純台灣牛肉水餃<br></th>
                            <th><button onclick="plus(this, -1)" style="font-size: 18px;">-</button></th>
                            <th>1</th>
                            <th><button onclick="plus(this, 1)" style="font-size: 18px;">+</button></th>
                            <th><button class="addCart"><img src="./img cs/images.jpg" alt="加入購物車"
                                        style="height: 30px ;"></button></th>
                        </tr>
                        <th price="450" style="width: 200px;text-align: left;">$450</th>
                    </table>
                </div>
                <div><a href="./商品分頁/高麗菜.html"><img src="./img_product/pr/6.jpg" alt=""></a><br>
                    <table>
                        <tr>
                            <th PID="A6" price="430" style="width: 200px;text-align: left;">四季豆鮮肉水餃<br></th>
                            <th><button onclick="plus(this, -1)" style="font-size: 18px;">-</button></th>
                            <th>1</th>
                            <th><button onclick="plus(this, 1)" style="font-size: 18px;">+</button></th>
                            <th><button class="addCart"><img src="./img cs/images.jpg" alt="加入購物車"
                                        style="height: 30px ;"></button></th>
                        </tr>
                        <tr>
                            <th price="430" style="width: 200px;text-align: left;">$430</th>
                        </tr>
                    </table>
                </div>
                <div><a href="./餛飩.html"><img src="./img_product/pr/8.jpg"></a><br>
                    <table>
                        <tr>
                            <th PID="B1" price="165" style="width: 200px;text-align: left;">鮮肉餛飩<br></th>
                            <th><button onclick="plus(this, -1)" style="font-size: 18px;">-</button></th>
                            <th>1</th>
                            <th><button onclick="plus(this, 1)" style="font-size: 18px;">+</button></th>
                            <th><button class="addCart"><img src="./img cs/images.jpg" alt="加入購物車"
                                        style="height: 30px ;"></button></th>
                        </tr>
                        <tr>
                            <th price="165" style="width: 200px;text-align: left;">$165</th>
                        </tr>
                    </table>
                </div>
                <div><a href="./保冷袋.html"><img src="./img_product/pr/14.jpg"></a><br>
                    <table>
                        <tr>
                            <th PID="C1" price="690" style="width: 200px;text-align: left;">保冷袋<br></th>
                            <th><button onclick="plus(this, -1)" style="font-size: 18px;">-</button></th>
                            <th>1</th>
                            <th><button onclick="plus(this, 1)" style="font-size: 18px;">+</button></th>
                            <th><button class="addCart"><img src="./img cs/images.jpg" alt="加入購物車"
                                        style="height: 30px ;"></button></th>
                        </tr>
                        <tr>
                            <th price="690" style="width: 200px;text-align: left;">$690</th>
                        </tr>
                    </table>
                </div>

            </div>
        </div>
        <!-- 右 -->
        <div id="rightBlock"></div>


    </div>
    <div id="pageBottom">
        <hr>
        <a href="https://www.facebook.com/profile.php?id=100064288114627"><i class="fa fa-facebook"></i></a>
        <a href="https://www.facebook.com/profile.php?id=100064288114627"><i class="fa fa-instagram"></i></a>
        <a href="mailto:meicho@gmail.com">客服信箱：meicho@gmail.com</a>

    </div>
</body>
<script>

    function plus(sender, value) {
        let field = $(sender)
            .parents("tr")

            .children()
            .eq(2)


        let text = field.text()
        text = parseInt(text) + value
        if (text >= 1) {
            field.text(text)
        } else {
            text = 1
        }
    }
    // localstorage:存購物車
    // function addCart(){
    //     // console.log("ok")
    //     var pid = this.parent().children().eq(0)
    //     console.log(pid)
    //     localStorage.setItem("PID",)
    // }



    // localStorage.clear()
    $(function () { //頁面載入完成後執行
        // product頁及商品分頁的加到購物車
        $(".addCart").click(function () {
            var cart = [];
            if (localStorage.getItem("cart")) {
                cart = JSON.parse(localStorage.getItem("cart"))
            } // 取得目前cart[]
            console.log(cart)
            // console.log("ok")
            // console.log(this)
            var pName = $(this).parent().parent().children()[0].innerText
            // console.log(pName)

            var pID = $(this).parent().parent().children()[0].getAttribute("PID")
            // console.log(pID)

            var pImg = $(this).parent().parent().parent().parent().parent()[0].getElementsByTagName("img")[0].getAttribute("src")
            // console.log(pImg)

            var pQuanity = $(this).parent().parent().children()[2].innerText
            // console.log(pQuanity)

            var pPrice = $(this).parent().parent().parent().children()[1].getElementsByTagName("th")[0].getAttribute("price")
            // console.log(pPrice)


            let newItem;
            if (cart.length > 0) {
                let repeat = true;
                for (var i = 0; i < cart.length; i++) {
                    console.log('9999999999is here!')
                    if (cart[i].pID === pID) {
                        console.log('555555555is here!')
                        console.log(pName)
                        cart[i].pQuanity = parseInt(cart[i].pQuanity) + parseInt(pQuanity)
                        repeat = false;
                    }
                    console.log(pN)
                    if (cart.length > 0) {
                        pN.innerText = cart.length
                        $("#pN").css("background-color", "white");
                        $("#pN").css("border-color", "rgb(193, 39, 45)");
                    }
                }

                if (repeat) {
                    console.log('01010101is here!')
                    newItem = {
                        pName: pName,
                        pImg: pImg,
                        pQuanity: pQuanity,
                        pPrice: pPrice,
                        pID: pID
                    }
                    console.log(newItem)

                    cart.push(newItem)
                    console.log(cart)

                } console.log(pN)
                if (cart.length > 0) {
                    pN.innerText = cart.length
                    $("#pN").css("background-color", "white");
                    $("#pN").css("border-color", "rgb(193, 39, 45)");
                }

            } else {
                console.log("2is here")
                newItem = {
                    pName: pName,
                    pImg: pImg,
                    pQuanity: pQuanity,
                    pPrice: pPrice,
                    pID: pID
                }
                cart.push(newItem)
                console.log(cart)
            }
            console.log(cart)
            localStorage.setItem("cart", JSON.stringify(cart))

        })



        cart = [];
        cart = JSON.parse(localStorage.getItem("cart"))

        if(cart.length > 0){
            pN.innerText = cart.length
            $("#pN").css("background-color","white");
            $("#pN").css("border-color","rgb(193, 39, 45)");
        }

    })


</script>